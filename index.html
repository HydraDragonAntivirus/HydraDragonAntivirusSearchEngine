<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Hydra Dragon Antivirus Report</title>
  <!-- Link to external CSS -->
  <link rel="stylesheet" href="css/style.css">
</head>
<body>
  <h1>Hydra Dragon Antivirus Report</h1>
  <p>This report displays fully unknown benign and non benign IPs discovered by the Hydra Dragon Antivirus Search Engine.</p>
  
  <div id="whitelist-section">
    <h2>Fully Unknown Benign IPs</h2>
    <table id="whitelist-table">
      <thead>
        <tr>
          <th>IP</th>
          <th>Category</th>
          <th>Report Date</th>
          <th>Comment</th>
        </tr>
      </thead>
      <tbody></tbody>
    </table>
  </div>
  
  <div id="bulk-section">
    <h2>Fully Unknown Non‑Benign IPs</h2>
    <table id="bulk-table">
      <thead>
        <tr>
          <th>IP</th>
          <th>Category</th>
          <th>Report Date</th>
          <th>Comment</th>
        </tr>
      </thead>
      <tbody></tbody>
    </table>
  </div>
  
  <script>
    // Simple CSV parser assuming no commas inside quoted fields
    function parseCSV(text) {
      const lines = text.trim().split("\n");
      const rows = [];
      for (let line of lines) {
        // Split on commas not inside quotes
        const values = line.split(/,(?=(?:(?:[^"]*"){2})*[^"]*$)/);
        rows.push(values.map(v => v.replace(/^"|"$/g, '').trim()));
      }
      return rows;
    }
    
    // Load a CSV file and populate the table with the given ID
    function loadCSV(filename, tableId) {
      fetch(filename)
        .then(response => response.text())
        .then(text => {
          const data = parseCSV(text);
          // Skip header row (assumed to be first row)
          const tbody = document.getElementById(tableId).querySelector("tbody");
          for (let i = 1; i < data.length; i++) {
            const row = data[i];
            if (row.length < 4) continue;
            let ip = row[0];
            const category = row[1];
            const reportDate = row[2];
            const comment = row[3];
            // If the category is non‑empty (non‑benign), prepend "[.]" to the IP
            if (category && category !== "") {
              ip = "[.]" + ip;
            }
            const tr = document.createElement("tr");
            tr.innerHTML = `<td>${ip}</td><td>${category}</td><td>${reportDate}</td><td>${comment}</td>`;
            tbody.appendChild(tr);
          }
        })
        .catch(err => console.error("Error loading " + filename, err));
    }
    
    // Load both CSV files on page load
    loadCSV("WhitelistReport.csv", "whitelist-table");
    loadCSV("BulkReport.csv", "bulk-table");
  </script>
</body>
</html>
